@use "../../styles/mixins" as mixins;

$navTransTime: 0.3s;
$slideMenuPadding: true;

@layer base {

  .wrap {
    --nav-base-size: 28rem;
    --nav-min-size: 5rem;
    --nav-size: var(--nav-base-size);
    --header-size: 5rem;
    --nav-top: 0rem;

    box-sizing: border-box;
    width: 100%;
    max-width: 100%;

    &[data-hmode="fill"] {
      --nav-top: var(--header-size);

      >.body {
        >.header {
          width: calc(100% + var(--nav-size));
          z-index: 99;

          &[data-pos="left"] {
            margin-left: calc(var(--nav-size) * -1);
          }
        }
      }
    }

    &[data-hmode="scroll"] {
      >.body {
        >.header {
          position: relative;
        }

        >.main {
          --header-size: 0rem;
        }
      }
    }

    &[data-mode="visible"] {
      >.nav {
        .corner {
          display: none;
        }
      }

      >.body {
        >.header {
          .corner {
            display: none;
          }
        }
      }
    }

    &[data-mode="minimize"] {
      --nav-size: var(--nav-min-size);

      >.nav {
        @if $slideMenuPadding !=false {
          --nav-menu-pad: 0;
        }

        @include mixins.crossHover(false) {
          width: var(--nav-base-size);

          @if $slideMenuPadding !=false {
            --nav-menu-pad: inherit !important;
          }

          >.ncontent {
            overflow: auto;
          }
        }

        .corner {
          display: none;
        }

        >.ncontent {
          overflow: hidden;
        }
      }

      >.body {
        >.header {
          .corner {
            display: none;
          }
        }
      }
    }

    &[data-mode="manual"] {
      --nav-size: 0rem;

      >.nav {
        z-index: 96;
        top: var(--header-size);
        height: calc(100% - var(--header-size));

        .corner {
          display: none;
        }
      }
    }
  }

  .tglVis,
  .tglMin,
  .tglMnu {
    display: none !important;
  }

  .tglMnu {
    &:not(:checked) {
      &~.wrap {
        &[data-mode="manual"] {
          @if $slideMenuPadding !=false {
            --nav-menu-pad: 0 !important;
          }

          >.body {
            >.header {
              .menuOpen {
                display: unset;
              }
            }
          }
        }
      }
    }

    &:checked {
      &~.wrap {
        &[data-mode="manual"] {
          >.nav {
            width: var(--nav-base-size);

            >.ncontent {
              overflow: auto;
            }
          }

          >.mask {
            display: block;
          }

          >.body {
            >.header {
              position: sticky;
              top: 0;

              .menuHide {
                display: unset;
              }
            }
          }
        }
      }
    }
  }

  .menuOpen,
  .menuHide,
  .slideLeft,
  .slideRight,
  .slideClose {
    display: none;
  }

  .corner {
    box-sizing: border-box;
    height: var(--header-size);
    width: var(--nav-min-size);
    flex: none;
    position: relative;
    z-index: 98;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: margin-left $navTransTime, margin-right $navTransTime;
  }

  .btn {
    box-sizing: border-box;
    position: relative;
    height: var(--cs-m);
    width: var(--cs-m);
    border-radius: var(--radius);
    border: 0.1rem solid var(--c-border);
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    user-select: none;

    &::before {
      position: absolute;
      content: "";
      top: 0;
      left: 0;
      height: 100%;
      width: 100%;
      border-radius: var(--radius);
      background: var(--c-nav_);
      z-index: -1;
      opacity: 0;
      transition: opacity 0.2s;
    }

    @include mixins.crossHover {
      &::before {
        opacity: 0.1;
      }
    }
  }

  .mask {
    height: 100%;
    width: 100%;
    background: var(--c-mask);
    z-index: 95;
    position: fixed;
    top: 0;
    left: 0;
    height: 100dvh;
    width: 100dvw;
    display: none;
    user-select: none;
  }

  .nav {
    box-sizing: border-box;
    z-index: 98;
    position: fixed;
    top: var(--nav-top);
    height: calc(100% - var(--nav-top));
    width: var(--nav-size);
    background: var(--c-nav);
    color: var(--c-nav_);
    overflow: hidden;
    filter: drop-shadow(0 0 0.1rem var(--c-shadow));
    overscroll-behavior: contain;
    transition: width $navTransTime, height $navTransTime, top $navTransTime;
    display: flex;
    flex-flow: column nowrap;
    justify-content: flex-start;
    align-items: flex-start;

    @if $slideMenuPadding ==false {
      --nav-menu-pad: 0;
    }

    &[data-pos="left"] {
      left: 0;
    }

    &[data-pos="right"] {
      right: 0;
    }

    &::-webkit-scrollbar {
      height: 0 !important;
      width: 0 !important;
      background: transparent !important;
    }

    &::-webkit-scrollbar-thumb {
      border-radius: 0.2rem;
      background: var(--c-scroll);
    }
  }

  .ncontent {
    box-sizing: border-box;
    width: 100%;
    min-height: 0;
    flex: 1 1 0rem;
    overflow: auto;
    overscroll-behavior: contain;
    padding-bottom: 2rem;
  }

  .body {
    box-sizing: border-box;
    width: 100%;
    min-height: 100dvh;
    display: flex;
    flex-flow: column nowrap;
    justify-content: flex-start;
    align-items: flex-start;
    flex: 1;
    transition: padding-left $navTransTime, padding-right $navTransTime;

    &[data-pos="left"] {
      padding-left: var(--nav-size);
    }

    &[data-pos="right"] {
      padding-right: var(--nav-size);
    }
  }

  .header {
    box-sizing: border-box;
    z-index: 97;
    width: 100%;
    height: var(--header-size);
    position: sticky;
    top: 0;
    display: flex;
    flex-flow: row nowrap;
    justify-content: flex-start;
    align-items: center;
    background: var(--c-nav);
    color: var(--c-nav_);
    filter: drop-shadow(0 0 0.1rem var(--c-shadow));
    transition: width $navTransTime, margin-left $navTransTime;

    &[data-pos="left"] {
      >.corner {
        order: 1;
      }

      >.hcontent {
        order: 2;
      }
    }

    &[data-pos="right"] {
      >.corner {
        order: 2;
      }

      >.hcontent {
        order: 1;
      }
    }
  }

  .hcontent {
    box-sizing: border-box;
    flex: 1;
    display: flex;
    flex-flow: row nowrap;
    justify-content: flex-start;
    align-items: center;
    padding: 0 var(--b-s);
  }

  .main {
    box-sizing: border-box;
    width: 100%;
    flex: 1 1 0rem;
    display: flex;
    flex-flow: column nowrap;
    justify-content: flex-start;
    align-items: stretch;
  }

  .footer {
    box-sizing: border-box;
    width: 100%;
    display: flex;
    flex-flow: row nowrap;
    justify-content: center;
    align-items: center;
    background: var(--c-nav);
    color: var(--c-nav_);
    filter: drop-shadow(0 0 0.1rem var(--c-shadow));
    // position: sticky;
    // bottom: 0;
    padding: var(--b-xs);
    font-size: var(--fs-xs);
  }

  @media screen and (width >=980px) {
    .wrap {
      &[data-mode="auto"] {
        >.body {
          >.header {
            >.corner {
              display: none;
            }
          }
        }
      }
    }

    :is(.tglVis:not(:checked)+.tglMin:not(:checked), .tglVis:checked) {
      &~.wrap {
        &[data-mode="auto"] {
          >.nav {
            &[data-pos="left"] {
              >.corner {
                margin-left: calc(100% - var(--nav-min-size));
              }

              .slideLeft {
                display: unset;
              }
            }

            &[data-pos="right"] {
              .slideRight {
                display: unset;
              }
            }

            .btnVis {
              display: none;
            }
          }
        }
      }
    }

    .tglMin:checked {
      &~.wrap {
        &[data-mode="auto"] {
          --nav-size: var(--nav-min-size);

          >.nav {
            @if $slideMenuPadding !=false {
              --nav-menu-pad: 0;
            }

            @include mixins.crossHover(false) {
              width: var(--nav-base-size);

              @if $slideMenuPadding !=false {
                --nav-menu-pad: inherit !important;
              }

              >.ncontent {
                overflow: auto;
              }
            }

            &[data-pos="left"] {
              .slideRight {
                display: unset;
              }
            }

            &[data-pos="right"] {
              >.corner {
                margin-left: calc(100% - var(--nav-min-size));
              }

              .slideLeft {
                display: unset;
              }
            }

            .btnMin {
              display: none;
            }

            >.ncontent {
              overflow: hidden;
            }
          }
        }
      }
    }
  }

  @media screen and (width < 980px) {
    .wrap {
      &[data-mode="auto"] {
        --nav-size: var(--nav-min-size);

        >.nav {
          >.ncontent {
            overflow: hidden;
          }
        }
      }
    }

  }

  @media screen and (720px <=width < 980px) {
    .wrap {
      &[data-mode="auto"] {
        >.body {
          >.header {
            >.corner {
              display: none;
            }
          }
        }
      }
    }

    :is(.tglVis:not(:checked)+.tglMin:not(:checked), .tglMin:checked) {
      &~.wrap {
        &[data-mode="auto"] {
          >.nav {
            @if $slideMenuPadding !=false {
              --nav-menu-pad: 0 !important;
            }

            @include mixins.crossHover(false) {
              width: var(--nav-base-size);

              @if $slideMenuPadding !=false {
                --nav-menu-pad: inherit !important;
              }

              >.ncontent {
                overflow: auto;
              }
            }

            &[data-pos="left"] {
              .slideRight {
                display: unset;
              }
            }

            &[data-pos="right"] {
              >.corner {
                margin-left: calc(100% - var(--nav-min-size));
              }

              .slideLeft {
                display: unset
              }
            }

            .btnMin {
              display: none;
            }

            >.ncontent {
              overflow: hidden;
            }
          }
        }
      }
    }

    .tglVis:checked {
      &~.wrap {
        &[data-mode="auto"] {
          --nav-size: var(--nav-base-size);

          >.nav {
            &[data-pos="left"] {
              >.corner {
                margin-left: calc(100% - var(--nav-min-size));
              }

              .slideLeft {
                display: unset;
              }
            }

            &[data-pos="right"] {
              .slideRight {
                display: unset;
              }
            }

            .btnVis {
              display: none;
            }

            >.ncontent {
              overflow: auto;
            }
          }
        }
      }
    }
  }

  @media screen and (width < 720px) {
    .wrap {
      &[data-mode="auto"] {
        >.nav {
          z-index: 96;
          top: var(--header-size);
          height: calc(100% - var(--header-size));

          >.corner {
            display: none;
          }
        }
      }
    }

    .tglMnu {
      &:not(:checked) {
        &~.wrap {
          &[data-mode="auto"] {
            @if $slideMenuPadding !=false {
              --nav-menu-pad: 0 !important;
            }

            >.body {
              >.header {
                .menuOpen {
                  display: unset;
                }
              }
            }
          }
        }
      }

      &:checked {
        &~.wrap {
          &[data-mode="auto"] {
            >.nav {
              width: var(--nav-base-size);

              >.ncontent {
                overflow: auto;
              }
            }

            >.mask {
              display: block;
            }

            >.body {
              >.header {
                .menuHide {
                  display: unset;
                }
              }
            }
            
            &[data-hmode="scroll"] {
              >.body {
                >.header {
                  position: sticky;
                  top: 0;  
                }
              }
            }
          }
        }
      }
    }

    .wrap {
      &[data-mode="auto"] {
        --nav-size: 0rem !important;
      }
    }
  }

}