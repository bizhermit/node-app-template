@use "../../styles/mixins" as mixins;

$navTransTime: 0.3s;
$slideMenuPadding: true;

@layer base {

  .wrap {
    --nav-base-size: 28rem;
    --nav-min-size: 5rem;
    --nav-size: var(--nav-base-size);
    --header-size: 5rem;

    box-sizing: border-box;
    width: 100%;
    max-width: 100%;

    &[data-mode="visible"] {
      >.nav {
        top: 0;
        height: 100%;
      }

      >.body {
        >.header {
          &::before {
            display: none;
          }
        }
      }
    }

    &[data-mode="minimize"] {
      --nav-size: var(--nav-min-size);

      >.nav {
        overflow: hidden;
        z-index: 97;

        @if $slideMenuPadding !=false {
          --nav-menu-pad: 0;
        }

        @include mixins.crossHover(false) {
          width: var(--nav-base-size);
          overflow: auto;

          @if $slideMenuPadding !=false {
            --nav-menu-pad: inherit !important;
          }
        }
      }

      >.body {
        >.header {
          width: calc(100% + var(--nav-min-size));

          &::before {
            display: none;
          }

          &[data-pos="left"] {
            margin-left: calc(var(--nav-min-size) * -1);
          }
        }
      }
    }

    &[data-mode="manual"] {
      --nav-size: 0;

      >.nav {
        z-index: 97;
      }

      >.body {

        >.header {
          >.corner {
            margin-left: 0 !important;
            margin-right: 0 !important;
          }

          :is(.btnVis, .btnMin) {
            display: none;
          }
        }
      }
    }
  }

  .tglVis,
  .tglMin,
  .tglMnu {
    display: none !important;
  }

  .tglMnu {
    &:not(:checked) {
      &~.wrap {
        &[data-mode="manual"] {
          @if $slideMenuPadding !=false {
            --nav-menu-pad: 0 !important;
          }

          >.body {
            >.header {
              .menuOpen {
                display: unset;
              }
            }
          }
        }
      }
    }

    &:checked {
      &~.wrap {
        &[data-mode="manual"] {
          >.nav {
            width: var(--nav-base-size);
            overflow: auto;
          }

          >.mask {
            display: block;
          }

          >.body {
            >.header {
              .menuHide {
                display: unset;
              }
            }
          }
        }
      }
    }
  }

  .menuOpen,
  .menuHide,
  .slideLeft,
  .slideRight,
  .slideClose {
    display: none;
  }

  .corner {
    box-sizing: border-box;
    height: var(--header-size);
    width: var(--nav-min-size);
    display: flex;
    justify-content: center;
    align-items: center;
    transition: margin-left $navTransTime, margin-right $navTransTime;
  }

  .btn {
    box-sizing: border-box;
    position: relative;
    height: var(--cs-m);
    width: var(--cs-m);
    border-radius: var(--radius);
    border: 0.1rem solid var(--c-border);
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    user-select: none;

    &::before {
      position: absolute;
      content: "";
      top: 0;
      left: 0;
      height: 100%;
      width: 100%;
      border-radius: var(--radius);
      background: var(--c-nav_);
      z-index: -1;
      opacity: 0;
      transition: opacity 0.2s;
    }

    @include mixins.crossHover {
      &::before {
        opacity: 0.1;
      }
    }
  }

  .mask {
    height: 100%;
    width: 100%;
    background: var(--c-mask);
    z-index: 96;
    position: fixed;
    top: 0;
    left: 0;
    height: 100dvh;
    width: 100dvw;
    display: none;
    user-select: none;
  }

  .nav {
    box-sizing: border-box;
    z-index: 99;
    position: fixed;
    top: var(--header-size);
    height: calc(100% - var(--header-size));
    width: var(--nav-size);
    background: var(--c-nav);
    color: var(--c-nav_);
    overflow: auto;
    padding-bottom: 1rem;
    filter: drop-shadow(0 0 0.1rem var(--c-shadow));
    overscroll-behavior: contain;
    transition: width $navTransTime, height $navTransTime, top $navTransTime;

    @if $slideMenuPadding ==false {
      --nav-menu-pad: 0;
    }

    &[data-pos="left"] {
      left: 0;
    }

    &[data-pos="right"] {
      right: 0;
    }

    &::-webkit-scrollbar {
      height: 0 !important;
      width: 0 !important;
      background: transparent !important;
    }

    &::-webkit-scrollbar-thumb {
      border-radius: 0.2rem;
      background: var(--c-scroll);
    }
  }

  .body {
    box-sizing: border-box;
    width: 100%;
    min-height: 100dvh;
    display: flex;
    flex-flow: column nowrap;
    justify-content: flex-start;
    align-items: flex-start;
    flex: 1;
    transition: padding-left $navTransTime, padding-right $navTransTime;

    &[data-pos="left"] {
      padding-left: var(--nav-size);
    }

    &[data-pos="right"] {
      padding-right: var(--nav-size);
    }
  }

  .header {
    box-sizing: border-box;
    z-index: 98;
    width: 100%;
    height: var(--header-size);
    position: sticky;
    top: 0;
    display: flex;
    flex-flow: row nowrap;
    justify-content: flex-start;
    align-items: center;
    background: var(--c-nav);
    color: var(--c-nav_);
    filter: drop-shadow(0 0 0.1rem var(--c-shadow));
    transition: width $navTransTime, margin-left $navTransTime;

    &::before {
      box-sizing: border-box;
      position: absolute;
      content: "";
      width: var(--nav-size);
      height: var(--header-size);
      top: 0;
      background: var(--c-nav);
      transition: width $navTransTime;
      z-index: -1;
    }

    &[data-pos="left"] {
      &::before {
        right: 100%;
      }

      >.corner {
        order: 1;
        margin-left: calc(var(--nav-min-size) * -1);
      }

      >.hcontent {
        order: 2;
      }
    }

    &[data-pos="right"] {
      &::before {
        left: 100%;
      }

      >.corner {
        order: 2;
        margin-right: calc(var(--nav-min-size) * -1);
      }

      >.hcontent {
        order: 1;
      }
    }
  }

  .hcontent {
    box-sizing: border-box;
    flex: 1;
    display: flex;
    flex-flow: row nowrap;
    justify-content: flex-start;
    align-items: center;
    padding: 0 var(--b-s);
  }

  .main {
    box-sizing: border-box;
    width: 100%;
    flex: 1 1 0rem;
    display: flex;
    flex-flow: column nowrap;
    justify-content: flex-start;
    align-items: stretch;
  }

  .footer {
    box-sizing: border-box;
    width: 100%;
    display: flex;
    flex-flow: row nowrap;
    justify-content: center;
    align-items: center;
    background: var(--c-nav);
    color: var(--c-nav_);
    filter: drop-shadow(0 0 0.1rem var(--c-shadow));
    // position: sticky;
    // bottom: 0;
    padding: var(--b-xs);
    font-size: var(--fs-xs);
  }

  @media screen and (width >=980px) {
    .wrap {
      &[data-mode="auto"] {
        >.body {
          >.header {
            .btnMnu {
              display: none;
            }
          }
        }
      }
    }

    :is(.tglVis:not(:checked)+.tglMin:not(:checked), .tglVis:checked) {
      &~.wrap {
        &[data-mode="auto"] {
          >.nav {
            top: 0;
            height: 100%;
          }

          >.body {
            >.header {
              &[data-pos="left"] {
                >.corner {
                  margin-left: 0;
                }

                .slideLeft {
                  display: unset;
                }
              }

              &[data-pos="right"] {
                >.corner {
                  margin-right: 0;
                }

                .slideRight {
                  display: unset;
                }
              }

              .btnVis {
                display: none;
              }
            }
          }
        }
      }
    }

    .tglMin:checked {
      &~.wrap {
        &[data-mode="auto"] {
          --nav-size: var(--nav-min-size);

          >.nav {
            overflow: hidden;
            z-index: 97;

            @if $slideMenuPadding !=false {
              --nav-menu-pad: 0;
            }

            @include mixins.crossHover(false) {
              width: var(--nav-base-size);
              overflow: auto;

              @if $slideMenuPadding !=false {
                --nav-menu-pad: inherit !important;
              }
            }
          }

          >.body {
            >.header {
              &[data-pos="left"] {
                .slideRight {
                  display: unset;
                }
              }

              &[data-pos="right"] {
                .slideLeft {
                  display: unset;
                }
              }

              .btnMin {
                display: none;
              }
            }
          }
        }
      }
    }
  }

  @media screen and (width < 980px) {
    .wrap {
      &[data-mode="auto"] {
        --nav-size: var(--nav-min-size);

        >.nav {
          overflow: hidden;
        }
      }
    }

  }

  @media screen and (720px <=width < 980px) {
    .wrap {
      &[data-mode="auto"] {
        >.body {
          >.header {
            .btnMnu {
              display: none;
            }
          }
        }
      }
    }

    :is(.tglVis:not(:checked)+.tglMin:not(:checked), .tglMin:checked) {
      &~.wrap {
        &[data-mode="auto"] {
          >.nav {
            z-index: 97;

            @if $slideMenuPadding !=false {
              --nav-menu-pad: 0 !important;
            }

            @include mixins.crossHover(false) {
              width: var(--nav-base-size);
              overflow: auto;

              @if $slideMenuPadding !=false {
                --nav-menu-pad: inherit !important;
              }
            }
          }

          >.body {
            >.header {
              &[data-pos="left"] {
                .slideRight {
                  display: unset;
                }
              }

              &[data-pos="right"] {
                .slideLeft {
                  display: unset
                }
              }

              .btnMin {
                display: none;
              }
            }
          }
        }
      }
    }

    .tglVis:checked {
      &~.wrap {
        &[data-mode="auto"] {
          --nav-size: var(--nav-base-size);

          >.nav {
            top: 0;
            height: 100%;
            overflow: auto;
          }

          >.body {
            >.header {
              &[data-pos="left"] {
                >.corner {
                  margin-left: 0;
                }

                .slideLeft {
                  display: unset;
                }
              }

              &[data-pos="right"] {
                .corner {
                  margin-right: 0;
                }

                .slideRight {
                  display: unset;
                }
              }

              .btnVis {
                display: none;
              }
            }
          }

        }
      }
    }
  }

  @media screen and (width < 720px) {
    .wrap {
      &[data-mode="auto"] {
        >.nav {
          z-index: 97;
        }

        >.body {
          >.header {

            :is(.btnVis, .btnMin) {
              display: none;
            }
          }
        }
      }
    }

    .tglMnu {
      &:not(:checked) {
        &~.wrap {
          &[data-mode="auto"] {
            @if $slideMenuPadding !=false {
              --nav-menu-pad: 0 !important;
            }

            >.body {
              >.header {
                .menuOpen {
                  display: unset;
                }
              }
            }
          }
        }
      }

      &:checked {
        &~.wrap {
          &[data-mode="auto"] {
            >.nav {
              width: var(--nav-base-size);
              overflow: auto;
            }

            >.mask {
              display: block;
            }

            >.body {
              >.header {
                .menuHide {
                  display: unset;
                }
              }
            }
          }
        }
      }
    }

    .wrap {
      &[data-mode="auto"] {
        --nav-size: 0 !important;

        >.body {
          >.header {
            >.corner {
              margin-left: 0 !important;
              margin-right: 0 !important;
            }
          }
        }
      }
    }
  }

}